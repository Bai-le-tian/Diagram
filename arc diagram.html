
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Arc Diagram 弧线图</title>
    <style>::-webkit-scrollbar{display:none;}html,body{overflow:hidden;margin:0;}</style>
</head>
<body>
<div id="mountNode"></div>
<script>/*Fixing iframe window.innerHeight 0 issue in Safari*/document.body.clientHeight;</script>
<script src="https://gw.alipayobjects.com/os/antv/pkg/_antv.g6-3.1.1/build/g6.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/lib/jquery-3.2.1.min.js"></script>
<style>
  .g6-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
</style>
<script>
  var colors = ['rgb(64, 174, 247)', 'rgb(108, 207, 169)', 'rgb(157, 223, 125)', 'rgb(240, 198, 74)', 'rgb(221, 158, 97)', 'rgb(141, 163, 112)', 'rgb(115, 136, 220)', 'rgb(133, 88, 219)', 'rgb(203, 135, 226)', 'rgb(227, 137, 163)'];
  var graph = new G6.Graph({
    container: 'mountNode',
    width: window.innerWidth,
    height: window.innerHeight,
    linkCenter: true,
    modes: {
      default: [{
        type: 'edge-tooltip',
        formatText: function formatText(model) {
          var text = 'source: ' + model.sourceName + '<br/> target: ' + model.targetName;
          return text;
        },

        shouldUpdate: function shouldUpdate(e) {
          return true;
        }
    }]
    },
    defaultNode: {
      size: [10, 10],
      color: 'steelblue',
      style: {
        opacity: 0.8,
        lineWidth: 1,
        stroke: '#999'
      }
    },
    defaultEdge: {
      size: 1,
      color: '#e2e2e2',
      style: {
        opacity: 0.6,
        lineAppendWidth: 3
      }
    }
  });
  graph.on('edge:mouseenter', function(e) {
    var edge = e.item;
    graph.setItemState(edge, 'hover', true);
  });
  graph.on('edge:mouseleave', function(e) {
    var edge = e.item;
    graph.setItemState(edge, 'hover', false);
  });


    var edges = [{
    "source": "10",
    "target": "10",
    "sourceWeight": 61,
    "targetWeight": 61
  }, {
    "source": "11",
    "target": "11",
    "sourceWeight": 39,
    "targetWeight": 39
  }, {
    "source": "3",
    "target": "3",
    "sourceWeight": 30,
    "targetWeight": 30
  }, {
    "source": "19",
    "target": "19",
    "sourceWeight": 26,
    "targetWeight": 26
  }, {
    "source": "13",
    "target": "13",
    "sourceWeight": 23,
    "targetWeight": 23
  }, {
    "source": "9",
    "target": "9",
    "sourceWeight": 22,
    "targetWeight": 22
  }, {
    "source": "12",
    "target": "12",
    "sourceWeight": 19,
    "targetWeight": 19
  }, {
    "source": "28",
    "target": "19",
    "sourceWeight": 34,
    "targetWeight": 0
  }, {
    "source": "4",
    "target": "4",
    "sourceWeight": 16,
    "targetWeight": 16
  }, {
    "source": "11",
    "target": "10",
    "sourceWeight": 32,
    "targetWeight": 0
  }, {
    "source": "28",
    "target": "28",
    "sourceWeight": 14,
    "targetWeight": 14
  }, {
    "source": "18",
    "target": "18",
    "sourceWeight": 12,
    "targetWeight": 12
  }, {
    "source": "26",
    "target": "26",
    "sourceWeight": 11,
    "targetWeight": 11
  }, {
    "source": "28",
    "target": "13",
    "sourceWeight": 20,
    "targetWeight": 0
  }, {
    "source": "5",
    "target": "6",
    "sourceWeight": 17,
    "targetWeight": 2
  }, {
    "source": "19",
    "target": "13",
    "sourceWeight": 17,
    "targetWeight": 0
  }, {
    "source": "17",
    "target": "17",
    "sourceWeight": 7,
    "targetWeight": 7
  }, {
    "source": "6",
    "target": "6",
    "sourceWeight": 7,
    "targetWeight": 7
  }, {
    "source": "12",
    "target": "13",
    "sourceWeight": 14,
    "targetWeight": 0
  }, {
    "source": "1",
    "target": "19",
    "sourceWeight": 14,
    "targetWeight": 0
  }, {
    "source": "5",
    "target": "5",
    "sourceWeight": 7,
    "targetWeight": 7
  }, {
    "source": "21",
    "target": "19",
    "sourceWeight": 6,
    "targetWeight": 4
  }, {
    "source": "25",
    "target": "19",
    "sourceWeight": 10,
    "targetWeight": 0
  }, {
    "source": "0",
    "target": "0",
    "sourceWeight": 5,
    "targetWeight": 5
  }, {
    "source": "3",
    "target": "13",
    "sourceWeight": 9,
    "targetWeight": 0
  }, {
    "source": "20",
    "target": "19",
    "sourceWeight": 5,
    "targetWeight": 4
  }, {
    "source": "19",
    "target": "12",
    "sourceWeight": 9,
    "targetWeight": 0
  }, {
    "source": "0",
    "target": "19",
    "sourceWeight": 8,
    "targetWeight": 0
  }, {
    "source": "24",
    "target": "19",
    "sourceWeight": 8,
    "targetWeight": 0
  }, {
    "source": "22",
    "target": "22",
    "sourceWeight": 4,
    "targetWeight": 4
  }, {
    "source": "24",
    "target": "24",
    "sourceWeight": 4,
    "targetWeight": 4
  }, {
    "source": "26",
    "target": "3",
    "sourceWeight": 7,
    "targetWeight": 0
  }, {
    "source": "24",
    "target": "16",
    "sourceWeight": 7,
    "targetWeight": 0
  }, {
    "source": "16",
    "target": "16",
    "sourceWeight": 3,
    "targetWeight": 3
  }, {
    "source": "10",
    "target": "13",
    "sourceWeight": 6,
    "targetWeight": 0
  }, {
    "source": "7",
    "target": "7",
    "sourceWeight": 3,
    "targetWeight": 3
  }, {
    "source": "22",
    "target": "13",
    "sourceWeight": 6,
    "targetWeight": 0
  }, {
    "source": "20",
    "target": "20",
    "sourceWeight": 3,
    "targetWeight": 3
  }, {
    "source": "1",
    "target": "26",
    "sourceWeight": 6,
    "targetWeight": 0
  }, {
    "source": "27",
    "target": "19",
    "sourceWeight": 6,
    "targetWeight": 0
  }, {
    "source": "28",
    "target": "12",
    "sourceWeight": 6,
    "targetWeight": 0
  }, {
    "source": "22",
    "target": "7",
    "sourceWeight": 6,
    "targetWeight": 0
  }, {
    "source": "28",
    "target": "3",
    "sourceWeight": 6,
    "targetWeight": 0
  }, {
    "source": "17",
    "target": "7",
    "sourceWeight": 5,
    "targetWeight": 0
  }, {
    "source": "26",
    "target": "13",
    "sourceWeight": 5,
    "targetWeight": 0
  }, {
    "source": "27",
    "target": "13",
    "sourceWeight": 5,
    "targetWeight": 0
  }, {
    "source": "1",
    "target": "13",
    "sourceWeight": 5,
    "targetWeight": 0
  }, {
    "source": "1",
    "target": "3",
    "sourceWeight": 5,
    "targetWeight": 0
  }, {
    "source": "26",
    "target": "29",
    "sourceWeight": 3,
    "targetWeight": 2
  }, {
    "source": "22",
    "target": "16",
    "sourceWeight": 5,
    "targetWeight": 0
  }, {
    "source": "18",
    "target": "21",
    "sourceWeight": 4,
    "targetWeight": 0
  }, {
    "source": "22",
    "target": "12",
    "sourceWeight": 4,
    "targetWeight": 0
  }, {
    "source": "23",
    "target": "23",
    "sourceWeight": 2,
    "targetWeight": 2
  }, {
    "source": "17",
    "target": "29",
    "sourceWeight": 2,
    "targetWeight": 2
  }, {
    "source": "28",
    "target": "17",
    "sourceWeight": 4,
    "targetWeight": 0
  }, {
    "source": "15",
    "target": "15",
    "sourceWeight": 2,
    "targetWeight": 2
  }, {
    "source": "17",
    "target": "12",
    "sourceWeight": 4,
    "targetWeight": 0
  }, {
    "source": "27",
    "target": "27",
    "sourceWeight": 2,
    "targetWeight": 2
  }, {
    "source": "14",
    "target": "14",
    "sourceWeight": 2,
    "targetWeight": 2
  }, {
    "source": "18",
    "target": "29",
    "sourceWeight": 3,
    "targetWeight": 1
  }, {
    "source": "25",
    "target": "26",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "28",
    "target": "9",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "27",
    "target": "7",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "24",
    "target": "12",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "17",
    "target": "13",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "18",
    "target": "13",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "20",
    "target": "13",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "0",
    "target": "13",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "24",
    "target": "13",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "19",
    "target": "6",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "29",
    "target": "3",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "25",
    "target": "3",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "24",
    "target": "3",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "17",
    "target": "3",
    "sourceWeight": 3,
    "targetWeight": 0
  }, {
    "source": "0",
    "target": "15",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "28",
    "target": "26",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "24",
    "target": "26",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "16",
    "target": "13",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "1",
    "target": "14",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "29",
    "target": "21",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "21",
    "target": "21",
    "sourceWeight": 1,
    "targetWeight": 1
  }, {
    "source": "29",
    "target": "19",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "19",
    "target": "14",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "4",
    "target": "13",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "19",
    "target": "15",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "8",
    "target": "17",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "2",
    "target": "13",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "18",
    "target": "19",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "1",
    "target": "1",
    "sourceWeight": 1,
    "targetWeight": 1
  }, {
    "source": "23",
    "target": "17",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "23",
    "target": "19",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "0",
    "target": "3",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "18",
    "target": "3",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "19",
    "target": "3",
    "sourceWeight": 2,
    "targetWeight": 0
  }, {
    "source": "29",
    "target": "13",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "8",
    "target": "29",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "21",
    "target": "3",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "22",
    "target": "3",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "3",
    "target": "4",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "2",
    "target": "29",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "22",
    "target": "19",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "23",
    "target": "3",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "2",
    "target": "26",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "2",
    "target": "19",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "26",
    "target": "19",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "2",
    "target": "17",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "27",
    "target": "3",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "5",
    "target": "13",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "2",
    "target": "12",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "28",
    "target": "20",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "18",
    "target": "28",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "23",
    "target": "21",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "8",
    "target": "6",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "2",
    "target": "3",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "1",
    "target": "29",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "23",
    "target": "28",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "6",
    "target": "13",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "25",
    "target": "13",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "8",
    "target": "7",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "7",
    "target": "13",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "27",
    "target": "26",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "18",
    "target": "7",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "0",
    "target": "26",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "19",
    "target": "7",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "8",
    "target": "19",
    "sourceWeight": 1,
    "targetWeight": 0
  }, {
    "source": "28",
    "target": "29",
    "sourceWeight": 1,
    "targetWeight": 0
  }]

    var nodes = [{
    "id": "0",
    "name": "analytics.cluster",
    "cluster": "analytics",
    "value": 21
  }, {
    "id": "1",
    "name": "analytics.graph",
    "cluster": "analytics",
    "value": 34
  }, {
    "id": "2",
    "name": "analytics.optimization",
    "cluster": "analytics",
    "value": 8
  }, {
    "id": "3",
    "name": "animate",
    "cluster": "animate",
    "value": 40
  }, {
    "id": "4",
    "name": "animate.interpolate",
    "cluster": "animate",
    "value": 18
  }, {
    "id": "5",
    "name": "data.converters",
    "cluster": "data",
    "value": 25
  }, {
    "id": "6",
    "name": "data",
    "cluster": "data",
    "value": 10
  }, {
    "id": "7",
    "name": "display",
    "cluster": "display",
    "value": 4
  }, {
    "id": "8",
    "name": "flex",
    "cluster": "flex",
    "value": 6
  }, {
    "id": "9",
    "name": "physics",
    "cluster": "physics",
    "value": 22
  }, {
    "id": "10",
    "name": "query",
    "cluster": "query",
    "value": 67
  }, {
    "id": "11",
    "name": "query.methods",
    "cluster": "query",
    "value": 71
  }, {
    "id": "12",
    "name": "scale",
    "cluster": "scale",
    "value": 33
  }, {
    "id": "13",
    "name": "util",
    "cluster": "util",
    "value": 23
  }, {
    "id": "14",
    "name": "util.heap",
    "cluster": "util",
    "value": 2
  }, {
    "id": "15",
    "cluster": "util",
    "name": "util.math",
    "value": 2
  }, {
    "id": "16",
    "name": "util.palette",
    "cluster": "util",
    "value": 5
  }, {
    "id": "17",
    "name": "vis.axis",
    "cluster": "vis",
    "value": 24
  }, {
    "id": "18",
    "name": "vis.controls",
    "cluster": "vis",
    "value": 28
  }, {
    "id": "19",
    "name": "vis.data",
    "cluster": "vis",
    "value": 70
  }, {
    "id": "20",
    "name": "vis.data.render",
    "cluster": "vis",
    "value": 11
  }, {
    "id": "21",
    "name": "vis.events",
    "cluster": "vis",
    "value": 8
  }, {
    "id": "22",
    "name": "vis.legend",
    "cluster": "vis",
    "value": 27
  }, {
    "id": "23",
    "name": "vis.operator.distortion",
    "cluster": "vis",
    "value": 9
  }, {
    "id": "24",
    "name": "vis.operator.encoder",
    "cluster": "vis",
    "value": 30
  }, {
    "id": "25",
    "name": "vis.operator.filter",
    "cluster": "vis",
    "value": 17
  }, {
    "id": "26",
    "name": "vis.operator",
    "cluster": "vis",
    "value": 27
  }, {
    "id": "27",
    "name": "vis.operator.label",
    "cluster": "vis",
    "value": 18
  }, {
    "id": "28",
    "name": "vis.operator.layout",
    "cluster": "vis",
    "value": 91
  }, {
    "id": "29",
    "name": "vis",
    "cluster": "vis",
    "value": 13
  }]
    var nodeMap = new Map();
    var clusterMap = new Map();
    var clusterId = 0;
    var n = nodes.length;
    var windowHeight = window.innerHeight;
    var windowWidth = window.innerWidth;
    var horiPadding = 50;
    var begin = [horiPadding, windowHeight * 0.7];
    var end = [windowWidth - horiPadding, windowHeight * 0.7];
    var xLength = end[0] - begin[0];
    var yLength = end[1] - begin[1];
    var xSep = xLength / n;
    var ySep = yLength / n;
    nodes.forEach(function(node, i) {
      node.x = begin[0] + i * xSep;
      node.y = begin[1] + i * ySep;
      nodeMap.set(node.id, node);
      // cluster
      if (node.cluster && clusterMap.get(node.cluster) === undefined) {
        clusterMap.set(node.cluster, clusterId);
        clusterId++;
      }
      var id = clusterMap.get(node.cluster);
      if (node.style) {
        node.style.fill = colors[id % colors.length];
      } else {
        node.style = {
          fill: colors[id % colors.length]
        };
      }
      // label
      node.label = node.name;
      node.labelCfg = {
        position: 'center',
        style: {
          rotate: 90,
          textAlign: 'start'
        }
      };
    // });
    edges.forEach(function(edge, i) {
      edge.shape = 'arc';
      var source = nodeMap.get(edge.source);
      var target = nodeMap.get(edge.target);
      var endsSepStep = (target.x - source.x) / xSep;
      var sign = endsSepStep < 0 ? -1 : 1;
      var curveOffset = sign * 10 * Math.ceil(Math.abs(endsSepStep));
      edge.curveOffset = curveOffset;
      edge.color = source.style.fill;
      edge.sourceName = source.name;
      edge.targetName = target.name;
    });

    // map the value to node size
    var maxValue = -9999,
      minValue = 9999;
    nodes.forEach(function(n) {
      if (maxValue < n.value) maxValue = n.value;
      if (minValue > n.value) minValue = n.value;
    });
    var sizeRange = [3, 30];
    var sizeDataRange = [minValue, maxValue];
    scaleNodeProp(nodes, 'size', 'value', sizeDataRange, sizeRange);

    graph.data({"nodes":nodes,"edges":edges});
    graph.render();
  });

  function scaleNodeProp(nodes, propName, refPropName, dataRange, outRange) {
    var outLength = outRange[1] - outRange[0];
    var dataLength = dataRange[1] - dataRange[0];
    nodes.forEach(function(n) {
      n[propName] = (n[refPropName] - dataRange[0]) * outLength / dataLength + outRange[0];
    });
  }
</script></body>
</html>
